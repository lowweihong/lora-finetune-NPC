nohup: ignoring input
Note: Environment variable`HF_TOKEN` is set and is the current active token independently from the token you've just configured.

Map:   0%|          | 0/1723 [00:00<?, ? examples/s]
Map:  73%|███████▎  | 1263/1723 [00:00<00:00, 12490.67 examples/s]
Map: 100%|██████████| 1723/1723 [00:00<00:00, 10531.79 examples/s]

Creating json from Arrow format:   0%|          | 0/2 [00:00<?, ?ba/s]
Creating json from Arrow format: 100%|██████████| 2/2 [00:00<00:00, 55.51ba/s]

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.55s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.51s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.67s/it]
Padding-free training is enabled, but the attention implementation is not set to a supported flash attention variant. Padding-free training flattens batches into a single sequence, and only the following implementations are known to reliably support this: flash_attention_2, flash_attention_3, kernels-community/flash-attn, kernels-community/flash-attn3, kernels-community/vllm-flash-attn3. Using other implementations may lead to unexpected behavior. To ensure compatibility, set `attn_implementation` in the model configuration to one of these supported options or verify that your attention mechanism can handle flattened sequences.
You are using packing, but the attention implementation is not set to a supported flash attention variant. Packing gathers multiple samples into a single sequence, and only the following implementations are known to reliably support this: flash_attention_2, flash_attention_3, kernels-community/flash-attn, kernels-community/flash-attn3, kernels-community/vllm-flash-attn3. Using other implementations may lead to cross-contamination between samples. To avoid this, either disable packing by setting `packing=False`, or set `attn_implementation` in the model configuration to one of these supported options.

Tokenizing train dataset:   0%|          | 0/1723 [00:00<?, ? examples/s]
Tokenizing train dataset:  15%|█▍        | 251/1723 [00:00<00:00, 2475.64 examples/s]
Tokenizing train dataset:  30%|███       | 524/1723 [00:00<00:00, 2618.65 examples/s]
Tokenizing train dataset:  46%|████▌     | 791/1723 [00:00<00:00, 2639.23 examples/s]
Tokenizing train dataset:  66%|██████▌   | 1132/1723 [00:00<00:00, 2406.41 examples/s]
Tokenizing train dataset:  82%|████████▏ | 1418/1723 [00:00<00:00, 2545.95 examples/s]
Tokenizing train dataset:  99%|█████████▉| 1703/1723 [00:00<00:00, 2637.33 examples/s]
Tokenizing train dataset: 100%|██████████| 1723/1723 [00:00<00:00, 2350.69 examples/s]

Packing train dataset:   0%|          | 0/1723 [00:00<?, ? examples/s]
Packing train dataset: 100%|██████████| 1723/1723 [00:00<00:00, 23876.78 examples/s]
  0%|          | 0/140 [00:00<?, ?it/s]
  1%|          | 1/140 [00:16<38:06, 16.45s/it]
  1%|▏         | 2/140 [00:32<37:26, 16.28s/it]
  2%|▏         | 3/140 [00:48<37:07, 16.26s/it]
  3%|▎         | 4/140 [01:05<36:51, 16.26s/it]
  4%|▎         | 5/140 [01:21<36:30, 16.22s/it]
  4%|▍         | 6/140 [01:37<36:16, 16.24s/it]
  5%|▌         | 7/140 [01:53<35:59, 16.23s/it]
  6%|▌         | 8/140 [02:09<35:41, 16.23s/it]
  6%|▋         | 9/140 [02:26<35:27, 16.24s/it]
  7%|▋         | 10/140 [02:42<35:10, 16.23s/it]
                                                

  7%|▋         | 10/140 [02:42<35:10, 16.23s/it]
  8%|▊         | 11/140 [02:57<34:12, 15.91s/it]
  9%|▊         | 12/140 [03:13<34:08, 16.01s/it]
  9%|▉         | 13/140 [03:30<34:01, 16.07s/it]
 10%|█         | 14/140 [03:31<24:09, 11.50s/it]
 11%|█         | 15/140 [03:47<26:59, 12.96s/it]
 11%|█▏        | 16/140 [04:03<28:47, 13.93s/it]
 12%|█▏        | 17/140 [04:19<30:00, 14.63s/it]
 13%|█▎        | 18/140 [04:36<30:46, 15.13s/it]
 14%|█▎        | 19/140 [04:52<31:12, 15.47s/it]
 14%|█▍        | 20/140 [05:08<31:22, 15.69s/it]
                                                

 14%|█▍        | 20/140 [05:08<31:22, 15.69s/it]
 15%|█▌        | 21/140 [05:24<31:27, 15.86s/it]
 16%|█▌        | 22/140 [05:41<31:26, 15.98s/it]
 16%|█▋        | 23/140 [05:57<31:21, 16.08s/it]
 17%|█▋        | 24/140 [06:12<30:32, 15.80s/it]
 18%|█▊        | 25/140 [06:28<30:34, 15.95s/it]
 19%|█▊        | 26/140 [06:45<30:27, 16.03s/it]
 19%|█▉        | 27/140 [07:01<30:14, 16.05s/it]
 20%|██        | 28/140 [07:02<21:30, 11.52s/it]
 21%|██        | 29/140 [07:18<23:56, 12.94s/it]
 21%|██▏       | 30/140 [07:34<25:29, 13.90s/it]
                                                

 21%|██▏       | 30/140 [07:34<25:29, 13.90s/it]
 22%|██▏       | 31/140 [07:50<26:32, 14.61s/it]
 23%|██▎       | 32/140 [08:05<26:35, 14.78s/it]
 24%|██▎       | 33/140 [08:22<27:08, 15.22s/it]
 24%|██▍       | 34/140 [08:38<27:27, 15.54s/it]
 25%|██▌       | 35/140 [08:54<27:31, 15.73s/it]
 26%|██▌       | 36/140 [09:10<27:31, 15.88s/it]
 26%|██▋       | 37/140 [09:27<27:27, 16.00s/it]
 27%|██▋       | 38/140 [09:43<27:19, 16.07s/it]
 28%|██▊       | 39/140 [09:59<27:08, 16.13s/it]
 29%|██▊       | 40/140 [10:15<26:57, 16.17s/it]
                                                

 29%|██▊       | 40/140 [10:15<26:57, 16.17s/it]
 29%|██▉       | 41/140 [10:32<26:44, 16.21s/it]
 30%|███       | 42/140 [10:33<18:59, 11.63s/it]
 31%|███       | 43/140 [10:49<21:03, 13.03s/it]
 31%|███▏      | 44/140 [11:05<22:23, 14.00s/it]
 32%|███▏      | 45/140 [11:21<23:12, 14.66s/it]
 33%|███▎      | 46/140 [11:38<23:42, 15.13s/it]
 34%|███▎      | 47/140 [11:54<23:58, 15.47s/it]
 34%|███▍      | 48/140 [12:10<24:03, 15.69s/it]
 35%|███▌      | 49/140 [12:26<24:03, 15.86s/it]
 36%|███▌      | 50/140 [12:43<23:57, 15.97s/it]
                                                

 36%|███▌      | 50/140 [12:43<23:57, 15.97s/it]
 36%|███▋      | 51/140 [12:58<23:15, 15.68s/it]
 37%|███▋      | 52/140 [13:14<23:16, 15.87s/it]
 38%|███▊      | 53/140 [13:30<23:11, 15.99s/it]
 39%|███▊      | 54/140 [13:46<23:02, 16.07s/it]
 39%|███▉      | 55/140 [14:03<22:49, 16.11s/it]
 40%|████      | 56/140 [14:04<16:11, 11.56s/it]
 41%|████      | 57/140 [14:20<17:56, 12.98s/it]
 41%|████▏     | 58/140 [14:35<18:38, 13.64s/it]
 42%|████▏     | 59/140 [14:51<19:25, 14.39s/it]
 43%|████▎     | 60/140 [15:07<19:56, 14.95s/it]
                                                

 43%|████▎     | 60/140 [15:07<19:56, 14.95s/it]
 44%|████▎     | 61/140 [15:24<20:12, 15.35s/it]
 44%|████▍     | 62/140 [15:40<20:18, 15.62s/it]
 45%|████▌     | 63/140 [15:56<20:18, 15.82s/it]
 46%|████▌     | 64/140 [16:13<20:11, 15.95s/it]
 46%|████▋     | 65/140 [16:29<20:03, 16.04s/it]
 47%|████▋     | 66/140 [16:45<19:51, 16.10s/it]
 48%|████▊     | 67/140 [17:01<19:37, 16.13s/it]
 49%|████▊     | 68/140 [17:18<19:25, 16.18s/it]
 49%|████▉     | 69/140 [17:34<19:10, 16.20s/it]
 50%|█████     | 70/140 [17:35<13:33, 11.62s/it]
                                                

 50%|█████     | 70/140 [17:35<13:33, 11.62s/it]
 51%|█████     | 71/140 [17:51<14:58, 13.02s/it]
 51%|█████▏    | 72/140 [18:07<15:50, 13.97s/it]
 52%|█████▏    | 73/140 [18:24<16:23, 14.68s/it]
 53%|█████▎    | 74/140 [18:40<16:39, 15.14s/it]
 54%|█████▎    | 75/140 [18:56<16:45, 15.47s/it]
 54%|█████▍    | 76/140 [19:12<16:45, 15.71s/it]
 55%|█████▌    | 77/140 [19:29<16:41, 15.90s/it]
 56%|█████▌    | 78/140 [19:45<16:32, 16.01s/it]
 56%|█████▋    | 79/140 [20:01<16:19, 16.05s/it]
 57%|█████▋    | 80/140 [20:17<16:07, 16.12s/it]
                                                

 57%|█████▋    | 80/140 [20:17<16:07, 16.12s/it]
 58%|█████▊    | 81/140 [20:32<15:33, 15.83s/it]
 59%|█████▊    | 82/140 [20:49<15:24, 15.95s/it]
 59%|█████▉    | 83/140 [21:05<15:14, 16.05s/it]
 60%|██████    | 84/140 [21:06<10:44, 11.51s/it]
 61%|██████    | 85/140 [21:22<11:51, 12.94s/it]
 61%|██████▏   | 86/140 [21:38<12:31, 13.92s/it]
 62%|██████▏   | 87/140 [21:55<12:54, 14.62s/it]
 63%|██████▎   | 88/140 [22:11<13:05, 15.10s/it]
 64%|██████▎   | 89/140 [22:27<13:07, 15.44s/it]
 64%|██████▍   | 90/140 [22:43<13:03, 15.67s/it]
                                                

 64%|██████▍   | 90/140 [22:43<13:03, 15.67s/it]
 65%|██████▌   | 91/140 [23:00<12:57, 15.86s/it]
 66%|██████▌   | 92/140 [23:16<12:46, 15.97s/it]
 66%|██████▋   | 93/140 [23:31<12:19, 15.74s/it]
 67%|██████▋   | 94/140 [23:47<12:10, 15.88s/it]
 68%|██████▊   | 95/140 [24:03<11:59, 15.99s/it]
 69%|██████▊   | 96/140 [24:20<11:47, 16.07s/it]
 69%|██████▉   | 97/140 [24:36<11:33, 16.14s/it]
 70%|███████   | 98/140 [24:37<08:06, 11.58s/it]
 71%|███████   | 99/140 [24:53<08:52, 12.99s/it]
 71%|███████▏  | 100/140 [25:09<09:18, 13.95s/it]
                                                 

 71%|███████▏  | 100/140 [25:09<09:18, 13.95s/it]
 72%|███████▏  | 101/140 [25:26<09:30, 14.63s/it]
 73%|███████▎  | 102/140 [25:42<09:34, 15.11s/it]
 74%|███████▎  | 103/140 [25:58<09:32, 15.46s/it]
 74%|███████▍  | 104/140 [26:13<09:14, 15.39s/it]
 75%|███████▌  | 105/140 [26:30<09:07, 15.65s/it]
 76%|███████▌  | 106/140 [26:46<08:58, 15.83s/it]
 76%|███████▋  | 107/140 [27:02<08:46, 15.96s/it]
 77%|███████▋  | 108/140 [27:18<08:33, 16.04s/it]
 78%|███████▊  | 109/140 [27:35<08:19, 16.12s/it]
 79%|███████▊  | 110/140 [27:51<08:04, 16.15s/it]
                                                 

 79%|███████▊  | 110/140 [27:51<08:04, 16.15s/it]
 79%|███████▉  | 111/140 [28:07<07:47, 16.12s/it]
 80%|████████  | 112/140 [28:08<05:23, 11.57s/it]
 81%|████████  | 113/140 [28:24<05:50, 12.98s/it]
 81%|████████▏ | 114/140 [28:40<06:02, 13.95s/it]
 82%|████████▏ | 115/140 [28:57<06:05, 14.62s/it]
 83%|████████▎ | 116/140 [29:13<06:02, 15.12s/it]
 84%|████████▎ | 117/140 [29:29<05:56, 15.48s/it]
 84%|████████▍ | 118/140 [29:45<05:45, 15.69s/it]
 85%|████████▌ | 119/140 [30:02<05:32, 15.84s/it]
 86%|████████▌ | 120/140 [30:18<05:19, 15.98s/it]
                                                 

 86%|████████▌ | 120/140 [30:18<05:19, 15.98s/it]
 86%|████████▋ | 121/140 [30:34<05:05, 16.07s/it]
 87%|████████▋ | 122/140 [30:50<04:50, 16.12s/it]
 88%|████████▊ | 123/140 [31:05<04:28, 15.80s/it]
 89%|████████▊ | 124/140 [31:22<04:15, 15.94s/it]
 89%|████████▉ | 125/140 [31:38<04:00, 16.05s/it]
 90%|█████████ | 126/140 [31:39<02:41, 11.52s/it]
 91%|█████████ | 127/140 [31:55<02:47, 12.91s/it]
 91%|█████████▏| 128/140 [32:11<02:46, 13.90s/it]
 92%|█████████▏| 129/140 [32:28<02:40, 14.63s/it]
 93%|█████████▎| 130/140 [32:44<02:31, 15.13s/it]
                                                 

 93%|█████████▎| 130/140 [32:44<02:31, 15.13s/it]
 94%|█████████▎| 131/140 [33:00<02:19, 15.46s/it]
 94%|█████████▍| 132/140 [33:16<02:05, 15.69s/it]
 95%|█████████▌| 133/140 [33:33<01:51, 15.86s/it]
 96%|█████████▌| 134/140 [33:49<01:35, 15.98s/it]
 96%|█████████▋| 135/140 [34:05<01:20, 16.05s/it]
 97%|█████████▋| 136/140 [34:22<01:04, 16.13s/it]
 98%|█████████▊| 137/140 [34:38<00:48, 16.17s/it]
 99%|█████████▊| 138/140 [34:53<00:31, 15.83s/it]
 99%|█████████▉| 139/140 [35:09<00:15, 15.95s/it]
100%|██████████| 140/140 [35:10<00:00, 11.44s/it]
                                                 

100%|██████████| 140/140 [35:10<00:00, 11.44s/it]
                                                 

100%|██████████| 140/140 [35:12<00:00, 11.44s/it]
100%|██████████| 140/140 [35:12<00:00, 15.09s/it]
{'loss': 1.9281, 'grad_norm': 0.6350134611129761, 'learning_rate': 0.00019407407407407408, 'entropy': 1.8325935006141663, 'num_tokens': 162236.0, 'mean_token_accuracy': 0.5800430960953236, 'epoch': 0.75}
{'loss': 1.1462, 'grad_norm': 0.1924016773700714, 'learning_rate': 0.00017925925925925927, 'entropy': 1.1538995810457178, 'num_tokens': 308255.0, 'mean_token_accuracy': 0.7093567671002569, 'epoch': 1.45}
{'loss': 0.891, 'grad_norm': 0.15445411205291748, 'learning_rate': 0.00016444444444444444, 'entropy': 0.9069425689207541, 'num_tokens': 454228.0, 'mean_token_accuracy': 0.7502213684288231, 'epoch': 2.15}
{'loss': 0.7269, 'grad_norm': 0.2579311430454254, 'learning_rate': 0.00014962962962962963, 'entropy': 0.7386753261089325, 'num_tokens': 615467.0, 'mean_token_accuracy': 0.7938189670443535, 'epoch': 2.91}
{'loss': 0.5356, 'grad_norm': 0.2330271154642105, 'learning_rate': 0.00013481481481481482, 'entropy': 0.5616888162252065, 'num_tokens': 762497.0, 'mean_token_accuracy': 0.8484717849138621, 'epoch': 3.6}
{'loss': 0.4145, 'grad_norm': 0.22344695031642914, 'learning_rate': 0.00012, 'entropy': 0.44040924632871475, 'num_tokens': 907513.0, 'mean_token_accuracy': 0.8902673705204113, 'epoch': 4.3}
{'loss': 0.3399, 'grad_norm': 0.44372889399528503, 'learning_rate': 0.00010518518518518518, 'entropy': 0.3678128389087883, 'num_tokens': 1054585.0, 'mean_token_accuracy': 0.9063076892414609, 'epoch': 5.0}
{'loss': 0.3176, 'grad_norm': 0.11375612020492554, 'learning_rate': 9.037037037037038e-05, 'entropy': 0.34182552620768547, 'num_tokens': 1216766.0, 'mean_token_accuracy': 0.9115409940481186, 'epoch': 5.75}
{'loss': 0.317, 'grad_norm': 0.12010568380355835, 'learning_rate': 7.555555555555556e-05, 'entropy': 0.3164267314446939, 'num_tokens': 1362778.0, 'mean_token_accuracy': 0.9142028061119286, 'epoch': 6.45}
{'loss': 0.2913, 'grad_norm': 0.14490316808223724, 'learning_rate': 6.074074074074074e-05, 'entropy': 0.3106500321143382, 'num_tokens': 1508842.0, 'mean_token_accuracy': 0.9166209697723389, 'epoch': 7.15}
{'loss': 0.2822, 'grad_norm': 0.14427442848682404, 'learning_rate': 4.592592592592593e-05, 'entropy': 0.29210570342838765, 'num_tokens': 1670268.0, 'mean_token_accuracy': 0.9192624986171722, 'epoch': 7.91}
{'loss': 0.2765, 'grad_norm': 0.12971659004688263, 'learning_rate': 3.111111111111111e-05, 'entropy': 0.2886768249241081, 'num_tokens': 1817067.0, 'mean_token_accuracy': 0.920788189849338, 'epoch': 8.6}
{'loss': 0.2645, 'grad_norm': 0.14366109669208527, 'learning_rate': 1.62962962962963e-05, 'entropy': 0.2833472446009919, 'num_tokens': 1963171.0, 'mean_token_accuracy': 0.9215166520428013, 'epoch': 9.3}
{'loss': 0.2823, 'grad_norm': 0.6703752279281616, 'learning_rate': 1.4814814814814817e-06, 'entropy': 0.28721300009134654, 'num_tokens': 2109170.0, 'mean_token_accuracy': 0.9212680120725889, 'epoch': 10.0}
{'train_runtime': 2112.2836, 'train_samples_per_second': 0.989, 'train_steps_per_second': 0.066, 'train_loss': 0.5723964026996068, 'epoch': 10.0}
